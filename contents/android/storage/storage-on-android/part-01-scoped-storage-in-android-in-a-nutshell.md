# Scoped Storage in Android in a Nutshell

안드로이드 애플리케이션은 각자 고유의 내부 저장소가 있으며 서로의 내부 저장소에 접근할 수 없지만 외부 저장소는 접근 가능하다.

외부 저장소는 2가지 문제를 갖고 있다. 많은 앱들이 외부 저장소의 read 권한을 필요로하지만 대부분의 경우 간단한 작업만 수행한다. 즉, 모든 외부 저장소 접근이 필요하지 않지만 외부 저장소에 대한 모든 권한을 요청하는 경우가 있다.

또한 외부 저장소를 사용하는 경우 앱이 삭제되어도 외부 저장소의 공간을 차지할 수 있다.

Scoped Storage는 이 모든 문제를 해결해준다. 안드로이드 10에 소개되었지만 안드로이드 11부터 의무적이다. 이제 어떤 앱이 어떤 파일을 생성했는지 알 수 있기 때문에 앱이 삭제되면 같이 삭제된다. 또한 모든 앱이 공유 저장소의 자체 디렉토리에 접근할 수 있으며 권한 없이 컬렉션 안의 미디어 파일들을 저장할 수 있다. 앱에서 생성하거나 소유하지 않은 파일을 변경하고 싶다면 `createWriteRequest`, `createDeleteRequest`를 사용하면 된다. 이 함수를 사용하려면 유저의 권한이 필요하다. 또한 파일을 삭제하는 대신 trash에 넣어 30일 이후 삭제할 수 있다. 물론 30일 이전에 복구도 가능하다.

일부 앱(예: 파일 매니저)은 저장소의 모든 권한이 필요할 수 있다. 이 때 `MANAGE_EXTERNAL_STORAGE` 권한을 추가하여 파일시스템의 모든 파일에 접근할 수 있다. 이 권한은 구글의 리뷰가 필요하며, 실제로 이 권한이 필요한지 확인한다. 유저는 이 권한을 앱 설정에서 활성화 또는 비활성화 할 수 있다.

## References

* [Scoped Storage in Android in a Nutshell](https://www.youtube.com/watch?v=TkOzcyzH1hU&list=PLQkwcJG4YTCR9jZq8O19nUL2hLqmLYX4M)